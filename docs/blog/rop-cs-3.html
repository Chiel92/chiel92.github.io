<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 2.0.15"><title>Railroad Oriented Programming in C#: Part 3</title><link rel="stylesheet" href="/blog/unit-cs.6720997f.css"><base target="_parent"><script type="text/javascript" src="https://livejs.com/live.js"></script></head><body class="article"> <div id="header"> <h1>Railroad Oriented Programming in C#: Part 3</h1> </div> <div id="content"> <div class="sect1"> <h2 id="_creating_result_instances">Creating Result Instances</h2> <div class="sectionbody"> <div class="listingblock"> <div class="content"> <pre class="highlight"><code class="language-cs" data-lang="cs"><span class="hljs-function">Result&lt;User, <span class="hljs-built_in">string</span>&gt; <span class="hljs-title">GetUser</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> username</span>)</span> {
  <span class="hljs-keyword">var</span> user = Datastore.FindUser(username);
  <span class="hljs-keyword">if</span> (user == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Result&lt;User, <span class="hljs-built_in">string</span>&gt;.Failure(<span class="hljs-string">&quot;User has no email&quot;</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Result&lt;User, <span class="hljs-built_in">string</span>&gt;.Success(user);
}</code></pre> </div> </div> <div class="listingblock"> <div class="content"> <pre class="highlight"><code class="language-cs" data-lang="cs"><span class="hljs-function">Result&lt;User, <span class="hljs-built_in">string</span>&gt; <span class="hljs-title">GetUser</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> username</span>)</span> {
  <span class="hljs-keyword">var</span> user = Datastore.FindUser(username);
  <span class="hljs-keyword">if</span> (user == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Result.Fail(<span class="hljs-string">&quot;User has no email&quot;</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Result.Succeed(user);
}</code></pre> </div> </div> <div class="paragraph"> <p><a href="https://tyrrrz.me/blog/return-type-inference">Return type inference</a></p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight"><code class="language-cs" data-lang="cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt; {

  <span class="hljs-comment">// ...</span>

  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">operator</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt;(<span class="hljs-params">Result.GenericSuccess&lt;TR&gt; ok</span>)</span> =&gt; <span class="hljs-keyword">new</span> Success(ok.Value);
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">operator</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt;(<span class="hljs-params">Result.GenericFailure&lt;TE&gt; error</span>)</span> =&gt; <span class="hljs-keyword">new</span> Failure(error.Value);
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Result</span> {
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">GenericSuccess</span>&lt;<span class="hljs-title">TR</span>&gt; <span class="hljs-title">Succeed</span>&lt;<span class="hljs-title">TR</span>&gt;(<span class="hljs-params">TR result</span>)</span> =&gt; <span class="hljs-keyword">new</span>(result);
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">GenericFailure</span>&lt;<span class="hljs-title">TE</span>&gt; <span class="hljs-title">Fail</span>&lt;<span class="hljs-title">TE</span>&gt;(<span class="hljs-params">TE error</span>)</span> =&gt; <span class="hljs-keyword">new</span>(error);
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt; <span class="hljs-title">Succeed</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt;(<span class="hljs-params">TR result</span>)</span> =&gt; Succeed(result);
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt; <span class="hljs-title">Fail</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt;(<span class="hljs-params">TE error</span>)</span> =&gt; Fail(error);
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GenericSuccess&lt;Unit&gt; <span class="hljs-title">Succeed</span>(<span class="hljs-params"></span>)</span> =&gt; Succeed(Unit.<span class="hljs-built_in">unit</span>);
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GenericFailure&lt;Unit&gt; <span class="hljs-title">Fail</span>(<span class="hljs-params"></span>)</span> =&gt; Fail(Unit.<span class="hljs-built_in">unit</span>);

  <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">struct</span> GenericFailure&lt;T&gt; {
    <span class="hljs-keyword">public</span> T Value { <span class="hljs-keyword">get</span>; }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">GenericFailure</span>(<span class="hljs-params">T <span class="hljs-keyword">value</span></span>)</span> {
      Value = <span class="hljs-keyword">value</span>;
    }
  }

  <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">struct</span> GenericSuccess&lt;T&gt; {
    <span class="hljs-keyword">public</span> T Value { <span class="hljs-keyword">get</span>; }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">GenericSuccess</span>(<span class="hljs-params">T <span class="hljs-keyword">value</span></span>)</span> {
      Value = <span class="hljs-keyword">value</span>;
    }
  }
}</code></pre> </div> </div> <div class="sect2"> <h3 id="_sub_tracks">Sub tracks</h3> <div class="listingblock"> <div class="content"> <pre class="highlight"><code class="language-cs" data-lang="cs"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>Message to be printed on the screen<span class="hljs-doctag">&lt;/returns&gt;</span></span>
<span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">MailMessageToUser</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> username, <span class="hljs-built_in">string</span> msg, MailServer server1, MailServer server2</span>)</span> {
  <span class="hljs-keyword">return</span> GetUser(username)
    .OnSuccess(GetEmailAddress)
    .OnSuccess(emailAddress =&gt; CreateEmailMessage(emailAddress, msg))
    .OnSuccess(email =&gt; SendEmail(email, server1)
      .OnFailure(ex =&gt; ex <span class="hljs-keyword">switch</span> {
        ServerNotFoundException =&gt; SendEmail(email, server2).OnFailure&lt;<span class="hljs-built_in">string</span>&gt;(ex =&gt; Result.Fail(ex.Message)),
        _ =&gt; Result.Fail(ex.Message)
      })
    )
    .Handle(
      _ =&gt; <span class="hljs-string">&quot;Email sent&quot;</span>,
      error =&gt; {
        LogError(error);
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Email not sent&quot;</span>;
      }
    );
}</code></pre> </div> </div> <div class="imageblock kroki"> <div class="content"> <svg xmlns="http://www.w3.org/2000/svg" class="pikchr" width="1366" height="73" viewbox="0 0 1708.76 92.16"> <path d="M96,38 L 103,38 Q 111,38 111,52 L 111,55 Q 111,69 119,69 L 128,69" style="fill:none;stroke-width:2.16;stroke:orange"></path> <path d="M96,38L128,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <path d="M272,38L288,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <path d="M459,38 L 466,38 Q 473,38 473,52 L 473,55 Q 473,69 482,69 L 490,69" style="fill:none;stroke-width:2.16;stroke:orange"></path> <path d="M459,38L490,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <path d="M634,38L650,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <path d="M855,38 L 863,38 Q 870,38 870,52 L 870,55 Q 870,69 878,69 L 887,69" style="fill:none;stroke-width:2.16;stroke:orange"></path> <path d="M855,38L887,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <path d="M1031,38L1047,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <polygon points="1206,38 1195,42 1195,33" style="fill:orange"></polygon> <path d="M1163,38L1201,38" style="fill:none;stroke-width:2.16;stroke:orange"></path> <path d="M1319,38L1362,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <path d="M1163,38 L 1170,38 Q 1178,38 1178,52 L 1178,55 Q 1178,69 1185,69 L 1192,69" style="fill:none;stroke-width:2.16;stroke:orange"></path> <path d="M1163,38 L 1170,38 Q 1178,38 1178,52 L 1178,55 Q 1178,69 1185,69 L 1192,69" style="fill:none;stroke-width:2.16;stroke:orange"></path> <path d="M1319,38 L 1326,38 Q 1333,38 1333,52 L 1333,55 Q 1333,69 1341,69 L 1348,69" style="fill:none;stroke-width:2.16;stroke:orange"></path> <path d="M1163,38 L 1170,38 Q 1178,38 1178,23 L 1178,20 Q 1178,6 1192,6 L 1305,6 Q 1319,6 1333,6 Q 1348,6 1348,20 L 1348,23 Q 1348,38 1355,38 L 1362,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <polygon points="16,38 5,42 5,33" style="fill:#add8e6"></polygon> <path d="M2,38L10,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <path d="M16,53L96,53L96,23L16,23Z" style="fill:none;stroke-width:2.16;stroke:#000"></path> <text x="56" y="38" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central">GetUser</text> <path d="M164,74L236,74A36 36 0 0 0 272 38A36 36 0 0 0 236 2L164,2A36 36 0 0 0 128 38A36 36 0 0 0 164 74Z" style="fill:none;stroke-width:2.16;stroke:#000"></path> <path d="M2,69L288,69" style="fill:none;stroke-width:2.16;stroke:orange"></path> <polygon points="302,38 291,42 291,33" style="fill:#add8e6"></polygon> <path d="M288,38L296,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <path d="M302,53L459,53L459,23L302,23Z" style="fill:none;stroke-width:2.16;stroke:#000"></path> <text x="380" y="38" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central">GetEmailAddress</text> <path d="M526,74L598,74A36 36 0 0 0 634 38A36 36 0 0 0 598 2L526,2A36 36 0 0 0 490 38A36 36 0 0 0 526 74Z" style="fill:none;stroke-width:2.16;stroke:#000"></path> <path d="M288,69L650,69" style="fill:none;stroke-width:2.16;stroke:orange"></path> <polygon points="665,38 653,42 653,33" style="fill:#add8e6"></polygon> <path d="M650,38L659,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <path d="M665,53L855,53L855,23L665,23Z" style="fill:none;stroke-width:2.16;stroke:#000"></path> <text x="760" y="38" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central">CreateEmailMessage</text> <path d="M923,74L995,74A36 36 0 0 0 1031 38A36 36 0 0 0 995 2L923,2A36 36 0 0 0 887 38A36 36 0 0 0 923 74Z" style="fill:none;stroke-width:2.16;stroke:#000"></path> <path d="M650,69L1047,69" style="fill:none;stroke-width:2.16;stroke:orange"></path> <polygon points="1061,38 1050,42 1050,33" style="fill:#add8e6"></polygon> <path d="M1047,38L1056,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <path d="M1061,53L1163,53L1163,23L1061,23Z" style="fill:none;stroke-width:2.16;stroke:#000"></path> <text x="1112" y="38" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central">SendEmail</text> <path d="M1206,53L1319,53L1319,23L1206,23Z" style="fill:none;stroke-width:2.16;stroke:#000"></path> <text x="1263" y="38" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central">SendEmail2</text> <path d="M1047,69L1362,69" style="fill:none;stroke-width:2.16;stroke:orange"></path> <polygon points="1377,38 1365,42 1365,33" style="fill:#add8e6"></polygon> <path d="M1362,38L1371,38" style="fill:none;stroke-width:2.16;stroke:#add8e6"></path> <polygon points="1377,69 1365,74 1365,65" style="fill:orange"></polygon> <path d="M1362,69L1371,69" style="fill:none;stroke-width:2.16;stroke:orange"></path> <path d="M1377,69L1449,69L1449,38L1377,38Z" style="fill:none;stroke-width:2.16;stroke:#000"></path> <text x="1413" y="54" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central">Handle</text> <path d="M1449,54L1463,54" style="fill:none;stroke-width:2.16;stroke:#000"></path> <path d="M1499,90L1571,90A36 36 0 0 0 1607 54A36 36 0 0 0 1571 18L1499,18A36 36 0 0 0 1463 54A36 36 0 0 0 1499 90Z" style="fill:none;stroke-width:2.16;stroke:#000"></path> <polygon points="1622,54 1610,58 1610,49" style="fill:#000"></polygon> <path d="M1607,54L1616,54" style="fill:none;stroke-width:2.16;stroke:#000"></path> <path d="M1637,69L1691,69A15 15 0 0 0 1706 54L1706,54A15 15 0 0 0 1691 38L1637,38A15 15 0 0 0 1622 54L1622,54A15 15 0 0 0 1637 69Z" style="fill:none;stroke-width:2.16;stroke:#000"></path> <text x="1664" y="54" text-anchor="middle" fill="rgb(0,0,0)" dominant-baseline="central">message</text> </svg> </div> </div> </div> <div class="sect2"> <h3 id="_the_code_so_far">The Code so far</h3> <div class="listingblock"> <div class="content"> <pre class="highlight"><code class="language-cs" data-lang="cs">  <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt; {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TNextR</span>, <span class="hljs-title">TE</span>&gt; <span class="hljs-title">OnSuccess</span>&lt;<span class="hljs-title">TNextR</span>&gt;(<span class="hljs-params">Func&lt;TR, Result&lt;TNextR, TE&gt;&gt; onSuccess</span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TNextE</span>&gt; <span class="hljs-title">OnFailure</span>&lt;<span class="hljs-title">TNextE</span>&gt;(<span class="hljs-params">Func&lt;TE, Result&lt;TR, TNextE&gt;&gt; onFailure</span>)</span>;
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> Prefer <span class="hljs-doctag">&lt;see cref=&quot;OnSuccess&quot;&gt;</span> and <span class="hljs-doctag">&lt;see cref=&quot;OnFailure&quot;&gt;</span> over this method for returning Result types.</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> TReturn <span class="hljs-title">Handle</span>&lt;<span class="hljs-title">TReturn</span>&gt;(<span class="hljs-params">Func&lt;TR, TReturn&gt; onSuccess, Func&lt;TE, TReturn&gt; onFailure</span>)</span>;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">IsSuccess</span>(<span class="hljs-params"></span>)</span> =&gt; <span class="hljs-keyword">this</span> <span class="hljs-keyword">is</span> Success;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">IsFailure</span>(<span class="hljs-params"></span>)</span> =&gt; <span class="hljs-keyword">this</span> <span class="hljs-keyword">is</span> Failure;

    <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> Void overloads (Because void is not an actual type in .NET)</span>

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">HandleVoid</span>(<span class="hljs-params">Action&lt;TR&gt; onSuccess, Action&lt;TE&gt; onFailure</span>)</span> {
      _ = onSuccess ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(onSuccess));
      _ = onFailure ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(onFailure));

      _ = Handle(onSuccess.AsFunc(), onFailure.AsFunc());
    }

    <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span>

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Success</span> : <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt; {
      <span class="hljs-keyword">public</span> TR ResultValue { <span class="hljs-keyword">get</span>; }

      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Success</span>(<span class="hljs-params">TR result</span>)</span> =&gt; ResultValue = result;

      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TNextR</span>, <span class="hljs-title">TE</span>&gt; <span class="hljs-title">OnSuccess</span>&lt;<span class="hljs-title">TNextR</span>&gt;(<span class="hljs-params">Func&lt;TR, Result&lt;TNextR, TE&gt;&gt; onSuccess</span>)</span>
          =&gt; onSuccess(ResultValue);

      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TNextE</span>&gt; <span class="hljs-title">OnFailure</span>&lt;<span class="hljs-title">TNextE</span>&gt;(<span class="hljs-params">Func&lt;TE, Result&lt;TR, TNextE&gt;&gt; onFailure</span>)</span>
          =&gt; Result.Succeed(ResultValue);

      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> TReturn <span class="hljs-title">Handle</span>&lt;<span class="hljs-title">TReturn</span>&gt;(<span class="hljs-params">Func&lt;TR, TReturn&gt; onSuccess, Func&lt;TE, TReturn&gt; onFailure</span>)</span>
          =&gt; onSuccess(ResultValue);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Failure</span> : <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt; {
      <span class="hljs-keyword">public</span> TE ErrorValue { <span class="hljs-keyword">get</span>; }

      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Failure</span>(<span class="hljs-params">TE error</span>)</span> =&gt; ErrorValue = error;

      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TNextR</span>, <span class="hljs-title">TE</span>&gt; <span class="hljs-title">OnSuccess</span>&lt;<span class="hljs-title">TNextR</span>&gt;(<span class="hljs-params">Func&lt;TR, Result&lt;TNextR, TE&gt;&gt; onSuccess</span>)</span>
          =&gt; Result.Fail(ErrorValue);

      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TNextE</span>&gt; <span class="hljs-title">OnFailure</span>&lt;<span class="hljs-title">TNextE</span>&gt;(<span class="hljs-params">Func&lt;TE, Result&lt;TR, TNextE&gt;&gt; onFailure</span>)</span>
          =&gt; onFailure(ErrorValue);

      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> TReturn <span class="hljs-title">Handle</span>&lt;<span class="hljs-title">TReturn</span>&gt;(<span class="hljs-params">Func&lt;TR, TReturn&gt; onSuccess, Func&lt;TE, TReturn&gt; onFailure</span>)</span>
          =&gt; onFailure(ErrorValue);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">operator</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt;(<span class="hljs-params">Result.GenericSuccess&lt;TR&gt; ok</span>)</span> =&gt; <span class="hljs-keyword">new</span> Success(ok.Value);

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">operator</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt;(<span class="hljs-params">Result.GenericFailure&lt;TE&gt; error</span>)</span> =&gt; <span class="hljs-keyword">new</span> Failure(error.Value);

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Result</span>(<span class="hljs-params"></span>)</span> { }
  }

  <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
  <span class="hljs-comment"><span class="hljs-doctag">///</span> This factory method class makes it possible to create result objects without having to specify the full result type explicitly.</span>
  <span class="hljs-comment"><span class="hljs-doctag">///</span> If the generic types cannot be inferred they can also be explicitly passed.</span>
  <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Result</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">GenericSuccess</span>&lt;<span class="hljs-title">TR</span>&gt; <span class="hljs-title">Succeed</span>&lt;<span class="hljs-title">TR</span>&gt;(<span class="hljs-params">TR result</span>)</span>
        =&gt; <span class="hljs-keyword">new</span>(result);

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">GenericFailure</span>&lt;<span class="hljs-title">TE</span>&gt; <span class="hljs-title">Fail</span>&lt;<span class="hljs-title">TE</span>&gt;(<span class="hljs-params">TE error</span>)</span>
        =&gt; <span class="hljs-keyword">new</span>(error);

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt; <span class="hljs-title">Succeed</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt;(<span class="hljs-params">TR result</span>)</span>
        =&gt; Succeed(result);

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">Result</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt; <span class="hljs-title">Fail</span>&lt;<span class="hljs-title">TR</span>, <span class="hljs-title">TE</span>&gt;(<span class="hljs-params">TE error</span>)</span>
        =&gt; Fail(error);

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GenericSuccess&lt;Unit&gt; <span class="hljs-title">Succeed</span>(<span class="hljs-params"></span>)</span>
        =&gt; Succeed(Unit.<span class="hljs-built_in">unit</span>);

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GenericFailure&lt;Unit&gt; <span class="hljs-title">Fail</span>(<span class="hljs-params"></span>)</span>
        =&gt; Fail(Unit.<span class="hljs-built_in">unit</span>);

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">struct</span> GenericFailure&lt;T&gt; {
      <span class="hljs-keyword">public</span> T Value { <span class="hljs-keyword">get</span>; }

      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">GenericFailure</span>(<span class="hljs-params">T <span class="hljs-keyword">value</span></span>)</span> {
        Value = <span class="hljs-keyword">value</span>;
      }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">struct</span> GenericSuccess&lt;T&gt; {
      <span class="hljs-keyword">public</span> T Value { <span class="hljs-keyword">get</span>; }

      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">GenericSuccess</span>(<span class="hljs-params">T <span class="hljs-keyword">value</span></span>)</span> {
        Value = <span class="hljs-keyword">value</span>;
      }
    }
  }</code></pre> </div> </div> </div> </div> </div> </div> <div id="footer"> <div id="footer-text"> Last updated 2021-08-02 10:53:37 +0200 </div> </div> </body></html>